//- HTML5 doctype
doctype html
html
  head

    //- Set default page title in case we forget to
    block title
      title= locals.settings.site_owner['company']

    // Meta
    meta(http-equiv='Content-Type', content='text/html; charset=UTF-8')
    meta(name='description', content= locals.settings.site_owner['company'])

    //- TODO: Add additional keywords
    meta(name='keywords', content= locals.settings.site_owner['company'] + ', law practice, law')

    // Required for Mobile Safari to present to us correctly at 1:1 scale
    meta(name='viewport', content='width=device-width, initial-scale=1.0')

    // Enable ClearType font rendering for MS IE
    meta(http-equiv="cleartype" content="on")

    //- Additional meta tags (per page)
    block meta

    if locals.settings.remote
      link(href='/css/google_cse.css', rel='stylesheet', type='text/css', media='screen')

    // CSS
    link(href='/css/common.css', rel='stylesheet', type='text/css', media='screen')
    link(href='/css/style.css', rel='stylesheet', type='text/css', media='screen')

    // Use mobile styling for both device and small desktop windows
    link(href='/css/mobile.css', rel='stylesheet', type='text/css', media='only screen and (max-width: 768px), only screen and (max-device-width: 768px)')

    // Google Web Fonts
    // http://www.google.com/fonts/
    if locals.settings.remote
      link(href='http://fonts.googleapis.com/css?family=Arbutus+Slab', rel='stylesheet', type='text/css')
      link(href='http://fonts.googleapis.com/css?family=Open+Sans:italic,400,600,800', rel='stylesheet', type='text/css')
      link(href='http://fonts.googleapis.com/css?family=Lora:italic,400,600,800', rel='stylesheet', type='text/css')

      // Experimental fonts
      //- link(href='http://fonts.googleapis.com/css?family=Adamina', rel='stylesheet', type='text/css')

    //- Additional web fonts (per page)
    block fonts

    // JavaScript
    if locals.settings.env === 'development'
      script(src='/js/lib/modernizr_v2.8.3.js')
    else
      script(src='/js/lib/modernizr_v2.8.3.min.js')

    script(src='/js/helpers.js')

    if locals.settings.remote
      script(src='/js/google_search.js')

    if locals.settings.env === 'development'
      script.
        document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1"></' + 'script>')

    //- Additional head-level block (specific per page)
    block head

  body(class='page')
      header
        div(class='header')
          a(class='company-header', href='/index')= locals.settings.site_owner['company']

          //- FIXME:
          //- img( align='', src='/images/logo_small.png', alt='')

          nav
            div(class='nav')

              - each link in locals.settings.nav_links
                //- NOTE (desktop): This breaks the highlighting of the practice
                //- page when viewing children:
                //- if link.href === locals.loc.href

                //- NOTE: Styled for both mobile and desktop
                if link.href === locals.loc.pathname
                  a(class='nav-link-parent nav-link-parent-active', href=link.href) #{link.title}
                else
                  a(class='nav-link-parent', href=link.href) #{link.title}

                // Breadcrumbs (child of parent page)
                //
                // NOTE: Mobile-only display
                - for( var i = 0; i != locals.breadcrumbs.length; ++i )
                  if link.href === locals.breadcrumbs[i].home
                    a(class='nav-link-child nav-link-child-active', href= locals.breadcrumbs[i].href )= locals.breadcrumbs[i].title

            //- Additional header-level elements (specific per page)
            block header

      div(class='content_container')

        //- Page content (specific per page)
        block content

      footer
        div(class='footer')
          div(align='center')
            form(action='/search_results', method='get')
              //- input(id='google_cse', class='search_input', type='search', name='q', spellcheck='false', autocomplete='off', accesskey='s', onfocus='', onblur='' )
              //- button(id='search_button', type='submit')

              //- FIXME:
              input(class='search_input', type='search', name='q', spellcheck='false', autocomplete='off', accesskey='s', placeholder='Search our site' )
              button(class='search_button', type='submit')
          div(align='center')
            br
            a( href= locals.settings.site_links['disclaimer'].href )= locals.settings.site_links['disclaimer'].title
            | &#32;|&#32;
            a( href= locals.settings.site_links['privacy'].href )= locals.settings.site_links['privacy'].title

            p( class='copyright' ) &#169; 2014 #{locals.settings.site_owner['company']}

          div(class='align_right')
            span(class='align_right copyright') Site design &#169; 2014 &#32;
              a( href= locals.settings.site_developer['website'] )= locals.settings.site_developer['name']

          //- Additional footer-level elements (specific per page)
          block footer

    // Additional JavaScripts (deferred loading)
    if locals.settings.env === 'development'
      //- script(src="/js/lib/jquery-1.11.1.js")
    else
      //- script(src="//ajax.googleapis.com/ajax/lib/jquery/1.11.1/jquery.min.js")

    if locals.settings.remote
      // Google Analytics
      script.
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-53873847-1', 'auto');
        ga('send', 'pageview');

    //- Additional deferred loading of JavaScripts (per page)
    block deferred_js
